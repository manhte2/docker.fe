import{j as t,af as O,n as Z,h as H,r as m,w as A,x as v,a as w,B as p,m as B,b as x,L as Y,D as I,d as y,T as L,al as U,R as W,H as X,y as T,F as G,S as g,V as b,l as D}from"./index-DCVJyVHf.js";const J=({className:j=""})=>t.jsx("span",{children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:O("size-5",j),children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"})})}),Q=()=>{const j=Z(),{i18n:S}=H(),[u,$]=m.useState([]),[h,F]=m.useState(),[f,E]=m.useState(),[n,k]=m.useState(""),M=h&&f&&!n?u.filter(e=>A(e.createdAt,h)&&v(e.createdAt,f)):h&&f&&n?u.filter(e=>{var s,r,l,o,a,i;return(((r=(s=e.userId)==null?void 0:s.username)==null?void 0:r.toLowerCase().includes(n.toLowerCase()))||((o=(l=e.userId)==null?void 0:l.phone)==null?void 0:o.toLowerCase().includes(n.toLowerCase()))||((i=(a=e.userId)==null?void 0:a.email)==null?void 0:i.toLowerCase().includes(n.toLowerCase())))&&A(e.createdAt,h)&&v(e.createdAt,f)}):n?u.filter(e=>{var s,r,l,o,a,i;return((r=(s=e.userId)==null?void 0:s.username)==null?void 0:r.toLowerCase().includes(n.toLowerCase()))||((o=(l=e.userId)==null?void 0:l.phone)==null?void 0:o.toLowerCase().includes(n.toLowerCase()))||((i=(a=e.userId)==null?void 0:a.email)==null?void 0:i.toLowerCase().includes(n.toLowerCase()))}):u;m.useEffect(()=>{C()},[]);const C=async()=>{try{const e=await w.get("/cashs");$(e.data)}catch(e){console.log("error - ",e),p.error(B.error)}},V=async e=>{const{_id:s,userId:{username:r,email:l},money:o}=e;try{const{isConfirmed:a}=await g.fire({title:`<p class="leading-tight">Bạn có muốn nạp cho người dùng <span class="text-secondary">${r||l}</span> số tiền <span class="text-secondary">${b.format(o)}VND</span></p>`,icon:"success",showCancelButton:!0,confirmButtonColor:"#1DC071",cancelButtonColor:"#d33",cancelButtonText:"Thoát",confirmButtonText:"Đồng ý"});a&&(await w.get(`/cashs/approve/${s}`),C(),p.success("Thành công"))}catch(a){console.log("error - ",a),p.error(B.error)}},_=async e=>{var a,i;const{_id:s,userId:{username:r,email:l},money:o}=e;try{const{isConfirmed:d}=await g.fire({title:`<p class="leading-tight">Bạn từ chối nạp cho người dùng <span class="text-secondary">${r||l}</span> số tiền <span class="text-secondary">${b.format(o)}VND</span></p>`,icon:"success",showCancelButton:!0,confirmButtonColor:"#1DC071",cancelButtonColor:"#d33",cancelButtonText:"Thoát",confirmButtonText:"Đồng ý"});if(d){const{value:N}=await g.fire({title:"<p class='leading-tight'>Lý do từ chối</p>",input:"text",showCancelButton:!0,cancelButtonText:"Thoát",confirmButtonText:"Đồng ý",inputValidator:c=>{if(!c)return"You need to write something!"}});if(N)try{const{isConfirmed:c}=await g.fire(`<p class="leading-tight">Bạn từ chối nạp cho <span class="text-secondary">${r} số tiền ${b.format(o)}NVD</span> với lý do <span class="text-secondary">${N}</span></p>`);c&&(await w.post(`/cashs/reject/${s}`,{description:N}),C(),p.success("Thành công"))}catch(c){if(D.isAxiosError(c))console.log("error message: ",c),p.error((a=c.response)==null?void 0:a.data.message);else return console.log("unexpected error: ",c),"An unexpected error occurred"}}}catch(d){if(D.isAxiosError(d))console.log("error message: ",d),p.error((i=d.response)==null?void 0:i.data.message);else return console.log("unexpected error: ",d),"An unexpected error occurred"}},R=m.useMemo(()=>[{title:()=>t.jsx("p",{className:"font-semibold font-primary",children:"STT"}),dataIndex:"index",key:"index",width:70,render:e=>t.jsx("p",{className:"text-sm font-primary",children:e+1})},{title:t.jsx("p",{className:"font-semibold font-primary",children:"Mã giao dịch"}),dataIndex:"code",key:"code",render:e=>t.jsx("p",{className:"text-sm font-primary",children:e})},{title:t.jsx("p",{className:"font-semibold font-primary",children:"Loại giao dịch"}),dataIndex:"type",key:"type",render:e=>t.jsx("p",{className:"text-sm font-primary",children:e===0?t.jsx(x,{color:"blue",children:"Auto Banking"}):t.jsx(x,{color:"pink-inverse",children:"Manual Banking"})}),filters:[{text:"Auto Banking",value:0},{text:"Manual Banking",value:1}],onFilter:(e,s)=>typeof e=="boolean"?s.type===(e?1:0):s.type===e},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Username"}),dataIndex:"username",key:"username",render:(e,s)=>{var r;return t.jsx(Y,{to:`/admin/account/${s.userId._id}`,className:"text-sm font-medium font-primary text-primary",children:(r=s.userId)==null?void 0:r.username})}},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Số tiền nạp"}),dataIndex:"money",key:"money",render:(e,s)=>t.jsxs("p",{className:"text-sm font-primary",children:[" ",j(s.money)]}),sorter:(e,s)=>e.money-s.money},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Ngày nạp"}),dataIndex:"createdAt",key:"createdAt",render:e=>t.jsx("p",{className:"text-sm font-primary",children:I(e)}),sorter:(e,s)=>y(e.createdAt).unix()-y(s.createdAt).unix()},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Ngày duyệt"}),dataIndex:"updatedAt",key:"updatedAt",render:(e,s)=>t.jsx("p",{className:"text-sm font-primary",children:s.status!==2?I(e):null}),sorter:(e,s)=>y(e.updatedAt).unix()-y(s.updatedAt).unix()},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Trạng thái"}),dataIndex:"status",key:"status",render:(e,s)=>t.jsxs("div",{className:"text-sm font-primary",children:[s.status===0?t.jsx(x,{color:"red",children:t.jsx("span",{className:"font-primary",children:"Đã hủy"})}):null,s.status===1?t.jsx(x,{color:"green",children:t.jsx("span",{className:"font-primary",children:"Đã thanh toán"})}):null,s.status===2?t.jsx(x,{color:"lime",children:t.jsx("span",{className:"font-primary",children:"Chờ phê duyệt"})}):null]}),filters:[{text:"Đã hủy",value:0},{text:"Đã hoàn thành",value:1},{text:"Chờ phê duyệt",value:2}],onFilter:(e,s)=>typeof e=="boolean"?s.status===(e?1:0):s.status===e},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Nội dung chuyển khoản"}),dataIndex:"content",key:"content",render:e=>t.jsx("p",{className:"text-sm font-primary text-primary",children:e||""})},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Lý do hủy"}),dataIndex:"description",key:"description",render:e=>t.jsx("p",{className:"text-sm font-primary text-error",children:e})},{title:()=>t.jsx("p",{className:"text-sm font-semibold font-primary",children:"Action"}),dataIndex:"action",key:"action",width:200,render:(e,s)=>t.jsx("div",{className:"flex gap-2 text-xs font-primary",children:t.jsxs(t.Fragment,{children:[t.jsx(L,{title:"Approve",children:t.jsx("button",{className:"px-2 aspect-square font-medium text-white rounded-md bg-[#389e0d]",onClick:()=>V(s),children:t.jsx(J,{className:"size-5"})})}),t.jsx(L,{title:"Cancel",children:t.jsx("button",{className:"px-2 aspect-square font-medium text-white rounded-md bg-error",onClick:()=>_(s),children:t.jsx(U,{className:"size-5"})})})]})})}],[S.language]),P=e=>{F(e)},q=e=>{E(e)},z=e=>{const s=e.target.value;k(s)};return t.jsx(W,{rolePage:[1,3],children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(X,{children:"Danh sách yêu cầu nạp"}),t.jsxs("div",{className:"items-center block gap-5 space-y-3 md:flex md:space-y-0",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("input",{type:"text",value:n,onChange:z,className:"focus:border-primary text-black text-sm font-medium placeholder:text-text4 py-[15px] px-[25px] rounded-[10px] border border-solid w-full bg-inherit peer outline-none border-strock",placeholder:"Tìm kiếm"}),n.length>0?t.jsx("span",{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",onClick:()=>k(""),children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-icon-color",children:t.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"})})}):null]}),t.jsxs("div",{className:"flex items-center gap-5",children:[t.jsx(T,{onChange:P,className:"!focus:border-primary text-black text-sm font-medium placeholder:text-text4 py-[15px] px-[25px] rounded-[10px] border border-solid w-full bg-inherit peer outline-none border-strock",placeholder:"Start date"}),t.jsx(T,{onChange:q,className:"!focus:border-primary text-black text-sm font-medium placeholder:text-text4 py-[15px] px-[25px] rounded-[10px] border border-solid w-full bg-inherit peer outline-none border-strock",placeholder:"End date"})]})]}),t.jsx("div",{className:"rounded-xl border-2 border-[#eeeeed] overflow-hidden",children:t.jsx(G,{dataSource:M.map((e,s)=>({index:s,...e})),columns:R,scroll:{x:1500,y:400}})})]})})};export{Q as default};
