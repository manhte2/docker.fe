import{h as I,r as p,q as A,a9 as R,ac as q,f as V,a8 as a,i as $,j as e,z,L as B,aa as n,ab as l,I as t,ae as _,k as M,o as G,a as C,B as d,l as K}from"./index-DCVJyVHf.js";import{L as U}from"./LayoutAuthentication-u7fbQ64F.js";const D=()=>{const{t:r,i18n:c}=I(),[L,g]=p.useState(!1),{email:x,role:f}=A(m=>m.auth),i=R(),{value:w,handleToogleValue:P}=q(),{value:j,handleToogleValue:F}=q(),v=p.useMemo(()=>V({username:a().required(r("form.username.error.required")).matches(/^[a-zA-Z0-9]+$/,{message:"Không được để khoảng trắng"}),email:a().required(r("form.email.error.required")).email(r("form.email.error.email")),password:a().required(r("form.password.error.required")).min(8,r("form.old_password.error.min")),rePassword:a().required(r("form.re_password.error.required")).min(8,r("form.old_password.error.min")),phone:a().required(r("form.phone.error.required")),introduceCode:a()}).required(),[r,c.language]),{handleSubmit:N,control:o,setError:T}=$({resolver:G(v),mode:"onChange"});p.useEffect(()=>{x&&i(f===1?"/admin/dashboard":"/user/dashboard")},[x,i,f]);const E=async m=>{var b;try{const{username:s,email:y,password:u,phone:k,rePassword:S,introduceCode:h}=m;u===S?(g(!0),h?h.length===7?(await C.post("/users",{username:s.toLowerCase(),email:y,password:u,country:"",phone:k,purpose:1,introduceCode:h}),i("/sign-in"),d.success("Đăng ký tài khoản thành công")):d.warn(c.language==="vi"?"Mã giới thiệu phải có độ dài 7 ký tự":(c.language==="en","Introduction code 07 charecters")):(await C.post("/users",{username:s.toLowerCase(),email:y,password:u,country:"",phone:k,purpose:1}),i("/sign-in"),d.success("Đăng ký tài khoản thành công"))):T("rePassword",{message:"Xác nhận mật khẩu không đúng"})}catch(s){if(K.isAxiosError(s))console.log("error message: ",s),d.error((b=s.response)==null?void 0:b.data.message);else return console.log("unexpected error: ",s),"An unexpected error occurred"}finally{g(!1)}};return e.jsxs(U,{heading:r("authen.sign_up"),children:[L&&e.jsx(z,{}),e.jsxs("p",{className:"mb-[25px] md:mb-[30px] text-xs font-normal text-center md:text-sm md:font-medium text-text3",children:[r("login.have_account")," ",e.jsx(B,{to:"/sign-in",className:"inline font-medium underline text-primary",children:r("authen.sign_in")})]}),e.jsxs("form",{className:"space-y-[15px] md:space-y-5",onSubmit:N(E),children:[e.jsxs(n,{children:[e.jsx(l,{htmlFor:"username",children:r("form.username.label")}),e.jsx(t,{name:"username",placeholder:r("form.username.placeholder"),control:o})]}),e.jsxs(n,{children:[e.jsx(l,{htmlFor:"email",children:r("form.email.label")}),e.jsx(t,{name:"email",placeholder:"example@gmail.com",control:o})]}),e.jsxs(n,{children:[e.jsx(l,{htmlFor:"phone",children:r("form.phone.label")}),e.jsx(t,{name:"phone",placeholder:r("form.phone.placeholder"),control:o})]}),e.jsxs(n,{children:[e.jsx(l,{htmlFor:"introduceCode",children:r("form.introduce_code.label")}),e.jsx(t,{name:"introduceCode",placeholder:r("form.introduce_code.placeholder"),control:o})]}),e.jsxs(n,{children:[e.jsx(l,{htmlFor:"password",children:r("form.password.label")}),e.jsx(t,{type:w?"text":"password",name:"password",placeholder:r("form.password.placeholder"),control:o,children:e.jsx(_,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:w,onClick:P})})]}),e.jsxs(n,{children:[e.jsx(l,{htmlFor:"password",children:r("form.re_password.label")}),e.jsx(t,{type:j?"text":"password",name:"rePassword",placeholder:r("form.re_password.placeholder"),control:o,children:e.jsx(_,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:j,onClick:F})})]}),e.jsx(M,{type:"submit",className:"w-full text-white bg-primary",children:r("authen.sign_up")})]})]})};export{D as default};
