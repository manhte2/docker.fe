import{f as V,g as m,r as t,a as u,B as x,m as v,i as A,j as e,L as g,V as w,D as Z,d as D,H as C,aa as j,ab as i,I as h,k as M,F as G,an as Y,av as J,R as K,o as H}from"./index-DCVJyVHf.js";const Q=V({value:m().required("This field is required"),min:m().required("This field is required")}).required(),se=()=>{const[r,p]=t.useState([]),[c,d]=t.useState(""),[l,o]=t.useState(),[f,y]=t.useState(!1),[n,N]=t.useState(),[T,k]=t.useState(1),[b,E]=t.useState(10),R=c?r.filter(s=>{var a,F,I;return((a=s==null?void 0:s.username)==null?void 0:a.toLowerCase().includes(c.toLowerCase()))||((F=s==null?void 0:s.email)==null?void 0:F.toLowerCase().includes(c.toLowerCase()))||((I=s==null?void 0:s.phone)==null?void 0:I.toLowerCase().includes(c.toLowerCase()))}):r;t.useEffect(()=>{P()},[T,b]);const P=async()=>{var s;try{y(!0);const a=await u.get("/users",{params:{page:T,pageSize:b,level:"1,2,3"}});p((s=a==null?void 0:a.data)==null?void 0:s.resultList),N(a.data.totalItems)}catch{x.error(v.error)}finally{y(!1)}},{handleSubmit:U,control:q,setValue:L}=A({resolver:H(Q),mode:"onSubmit"});t.useEffect(()=>{$()},[]),t.useEffect(()=>{l&&(L("value",l.value),L("min",l.min))},[l,L]);const _=async s=>{try{await u.post("/commisions",s),x.success("Thành công")}catch(a){console.log(a),x.error(v.error)}},$=async()=>{try{const s=await u.get("/commisions");o(s.data)}catch(s){console.log("error - ",s),x.error(v.error)}},z=t.useMemo(()=>[{title:()=>e.jsx("p",{className:"font-semibold font-primary",children:"STT"}),dataIndex:"index",key:"index",width:70,render:s=>e.jsx("p",{className:"text-sm font-primary",children:s+1})},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Username"}),dataIndex:"username",key:"username",render:(s,a)=>e.jsx(g,{to:`/admin/account/${a._id}`,className:"text-sm font-primary text-primary",children:s})},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Mã giới thiệu"}),dataIndex:"introduceCode",key:"introduceCode",render:s=>e.jsx("p",{className:"text-sm font-primary",children:s})},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Số dư"}),dataIndex:"money",key:"money",render:s=>e.jsxs("p",{className:"text-sm font-primary",children:[w.format(s),"VND"]}),sorter:{compare:(s,a)=>s.money-a.money,multiple:1},defaultSortOrder:"descend"},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Tổng nạp"}),dataIndex:"cash",key:"cash",render:s=>e.jsxs("p",{className:"text-sm font-primary",children:[w.format(s),"VND"]}),sorter:{compare:(s,a)=>s.cash-a.cash,multiple:1},defaultSortOrder:"descend"},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Số gói"}),dataIndex:"transaction",key:"transaction",width:100,render:(s,a)=>e.jsx("p",{className:"text-sm font-primary",children:a.transaction}),sorter:{compare:(s,a)=>s.transaction-a.transaction,multiple:2}},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Đại lý"}),dataIndex:"level",key:"level",render:(s,a)=>e.jsx("p",{className:"text-sm cursor-pointer font-primary text-primary",children:a.level===0?"Cộng tác viên":`Đại lý cấp ${a.level}`})},{title:()=>e.jsx("p",{className:"text-sm font-semibold font-primary",children:"Ngày tạo"}),dataIndex:"createdAt",key:"createdAt",render:s=>e.jsx("p",{className:"text-sm font-primary",children:Z(s)}),sorter:(s,a)=>D(s.createdAt).unix()-D(a.createdAt).unix()}],[]),B=s=>{const a=s.target.value;d(a)},O=(s,a)=>{k(1),E(a)};return e.jsxs("div",{className:"grid grid-cols-2 gap-10 lg:gap-20",children:[e.jsx("div",{className:"col-span-2 space-y-6 md:col-span-1",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(C,{children:"Chính sách CTV"}),e.jsxs("div",{className:"",children:[e.jsxs("p",{className:"mb-5",children:["Tỉ lệ % hoa hồng mà người dùng nhận được khi giới thiệu người dùng.",e.jsx("br",{}),"Chính sách hiện tại: ",l==null?void 0:l.value,"%"]}),e.jsxs("form",{className:"space-y-[15px] md:space-y-5",onSubmit:U(_),children:[e.jsxs(j,{children:[e.jsx(i,{htmlFor:"value",children:"Điều chỉnh chính sách hoa hồng mặc định:"}),e.jsx("div",{className:"flex gap-6",children:e.jsx(h,{name:"value",type:"number",placeholder:"% Hoa hồng",control:q,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"%"})})})]})," ",e.jsxs(j,{children:[e.jsx(i,{htmlFor:"value",children:"Số tiền tối thiểu làm cộng tác viên"}),e.jsx(h,{name:"min",type:"number",control:q,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"VND"})})]}),e.jsx(M,{type:"submit",className:"px-5 text-white bg-primary",children:"Apply"})]})]})]})}),e.jsxs("div",{className:"col-span-2 space-y-6 md:col-span-1",children:[e.jsx(C,{children:"Chính sách Đại lý"})," ",e.jsx(X,{})]}),e.jsxs("div",{className:"col-span-2 space-y-4",children:[e.jsxs("div",{className:"flex flex-col justify-between md:flex-row md:items-center",children:[e.jsx(C,{children:"Danh sách đại lý"}),e.jsxs("p",{className:"text-lg font-semibold",children:["Tổng doanh thu đại lý:"," ",e.jsxs("span",{className:"text-secondary20",children:[w.format(1e9),"VND"]})]})]}),e.jsx("div",{className:"flex items-center gap-5",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:c,onChange:B,className:"focus:border-primary text-black text-sm font-medium placeholder:text-text4 py-[15px] px-[25px] rounded-[10px] border border-solid w-full bg-inherit peer outline-none border-strock",placeholder:"Tìm kiếm"}),c.length>0?e.jsx("span",{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",onClick:()=>d(""),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5 text-icon-color",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"})})}):null]})}),e.jsx("div",{className:"rounded-xl border-2 border-[#eeeeed] overflow-hidden",children:e.jsx(G,{dataSource:R.map((s,a)=>({index:a,...s})),columns:z,loading:f,scroll:{y:420,x:1120},pagination:{defaultCurrent:1,total:n,onChange:s=>k(s),pageSize:b,onShowSizeChange:O}})})]})]})},W=V({level1:m().required("This field is required"),level2:m().required("This field is required"),level3:m().required("This field is required"),minLevel1:m().required("This field is required"),minLevel2:m().required("This field is required"),minLevel3:m().required("This field is required")}).required(),X=()=>{const[r,p]=t.useState(),c=Y(),{handleSubmit:d,control:l,setValue:o}=A({resolver:H(W),mode:"onSubmit"});t.useEffect(()=>{f()},[]),t.useEffect(()=>{r&&(o("level1",r.level1),o("level2",r.level2),o("level3",r.level3),o("minLevel1",r.minLevel1),o("minLevel2",r.minLevel2),o("minLevel3",r.minLevel3))},[r,o]);const f=async()=>{try{const n=await u.get("/collab");p(n.data),c(J({level1:n.data.level1,level2:n.data.level2,level3:n.data.level3,minLevel1:n.data.minLevel1,minLevel2:n.data.minLevel2,minLevel3:n.data.minLevel3}))}catch(n){console.log(n),x.error(v.error)}},y=async n=>{try{await u.post("/collab",n),f(),x.success("Thành công")}catch(N){console.log(N),x.error(v.error)}};return e.jsxs(K,{rolePage:[1],children:[e.jsx("p",{className:"mb-5",children:"Tỉ lệ % chiết khấu mà Đại lý nhận được khi mua gói cước."}),e.jsxs("form",{className:"space-y-[15px] md:space-y-6",onSubmit:d(y),children:[e.jsxs(j,{children:[e.jsxs(i,{htmlFor:"value",children:["Đại lý cấp 1: [Hiện tại có"," ",e.jsx(S,{level:1})," ",e.jsx(g,{to:"/admin/account?level=1",className:"font-medium underline text-primary decoration-primary",children:"Chi tiết"}),"]"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức chiết khấu"}),e.jsx(h,{name:"level1",type:"number",placeholder:"% Hoa hồng",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"%"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức doanh số tháng tối thiểu"}),e.jsx(h,{name:"minLevel1",type:"number",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"VND"})})]})]})]}),e.jsxs(j,{children:[e.jsxs(i,{htmlFor:"value",children:["Đại lý cấp 2: [Hiện tại có"," ",e.jsx(S,{level:2})," ",e.jsx(g,{to:"/admin/account?level=2",className:"font-medium underline text-primary decoration-primary",children:"Chi tiết"}),"]"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức chiết khấu"}),e.jsx(h,{name:"level2",type:"number",placeholder:"% Hoa hồng",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"%"})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức doanh số tháng tối thiểu"}),e.jsx(h,{name:"minLevel2",type:"number",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"VND"})})]})})]})]}),e.jsxs(j,{children:[e.jsxs(i,{htmlFor:"value",children:["Đại lý cấp 3: [Hiện tại có"," ",e.jsx(S,{level:3})," ",e.jsx(g,{to:"/admin/account?level=3",className:"font-medium underline text-primary decoration-primary",children:"Chi tiết"}),"]"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức chiết khấu"}),e.jsx(h,{name:"level3",type:"number",placeholder:"% Hoa hồng",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"%"})})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"value",children:"Mức doanh số tháng tối thiểu"}),e.jsx(h,{name:"minLevel3",type:"number",control:l,containerclass:"flex-1",children:e.jsx("span",{className:"absolute font-semibold -translate-y-1/2 cursor-pointer right-5 top-1/2 text-icon-color",children:"VND"})})]})})]})]}),e.jsx(M,{type:"submit",className:"px-5 text-white bg-primary",children:"Apply"})]})]})},S=({level:r})=>{const[p,c]=t.useState(0);return t.useEffect(()=>{(async()=>{try{const d=await u.get("/users",{params:{level:r}});c(d.data.totalItems)}catch(d){console.warn(d)}})()},[]),p};export{se as default};
