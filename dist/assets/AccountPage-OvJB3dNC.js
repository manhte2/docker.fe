import{h as R,r as p,f as H,a8 as h,a9 as Z,an as L,q as m,ac as A,i as M,j as e,H as I,T as E,c as ee,aa as u,ab as x,I as b,ae as V,k as D,a as v,R as se,ar as N,t as $,ah as ae,o as O,az as U,B as P,l as z}from"./index-DCVJyVHf.js";import{I as oe}from"./IconQuesionMarkCircle-Dri560o-.js";const le=()=>{const{t:s,i18n:_}=R(),k=p.useMemo(()=>H({oldPassword:h().required(s("form.old_password.error.required")).min(8,s("form.old_password.error.min")),newPassword:h().required(s("form.new_password.error.required")).min(8,s("form.old_password.error.min")),reNewPassword:h().required(s("form.re_new_password.error.required")).min(8,s("form.old_password.error.min"))}).required(),[s,_.language]),c=Z(),n=L(),g=m(r=>r.commision),t=m(r=>r.collab),{cash:q}=m(r=>r.satisfy),{_id:T,email:l,level:w,introduceCode:i,username:C}=m(r=>r.auth),{value:d,handleToogleValue:f}=A(),{value:a,handleToogleValue:j}=A(),{value:o,handleToogleValue:G}=A(),{handleSubmit:W,control:S,setError:Q}=M({resolver:O(k),mode:"onSubmit"}),J=async r=>{var B;const{newPassword:F,oldPassword:X,reNewPassword:Y}=r;try{F===Y?(await v.patch(`/users/change-password/${T}`,{oldPassword:X,newPassword:F}),n(U({})),c("/sign-in"),P.success(s("page.account.change_pass.success"))):Q("reNewPassword",{message:s("form.old_password.error.match")})}catch(y){if(z.isAxiosError(y))console.log("error message: ",y),P.error((B=y.response)==null?void 0:B.data.message);else return console.log("unexpected error: ",y),"An unexpected error occurred"}},K=s("page.account.info.tooltip",{commision:g,level1:t.level1,level2:t.level2,level3:t.level3});return e.jsxs("div",{className:"gap-16 grid grid-cols-5 md:grid-cols-10",children:[e.jsxs("div",{className:"space-y-4 col-span-5",children:[e.jsx(I,{children:s("page.account.info.heading")}),e.jsxs("div",{className:"space-y-4",children:[q>=5e4&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{title:`Giới thiệu mã CTV này cho bạn bè bạn sẽ nhận được [${g}%] hoa hồng cho mỗi giao dịch.`,children:e.jsxs("p",{className:"",children:[e.jsx("span",{className:"font-medium",children:s("page.account.info.field.code")})," ",e.jsx("span",{className:"text-[#3d6dae] font-semibold",children:i||""})]})}),e.jsx(E,{title:"copy",children:e.jsx("button",{className:"-translate-y-[2px] text-[#3d6dae]",onClick:()=>i&&ee(i),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})})})})]}),e.jsxs("p",{className:"",children:[e.jsx("span",{className:"font-medium",children:s("page.account.info.field.email")})," ",e.jsx("span",{className:"text-[#3d6dae] font-semibold",children:l})]}),e.jsxs("p",{className:"",children:[e.jsx("span",{className:"font-medium",children:s("page.account.info.field.username")})," ",e.jsx("span",{className:"text-[#3d6dae] font-semibold",children:C})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"",children:[e.jsx("span",{className:"font-medium",children:s("page.account.info.field.level")})," ",e.jsx("span",{className:"text-[#3d6dae] font-semibold",children:w===0?s("page.account.info.level"):s("page.account.info.leveln",{level:w})})]}),e.jsx(E,{title:K,children:e.jsx("span",{className:"cursor-pointer text-[#3d6dae]",children:e.jsx(oe,{})})})]}),e.jsx("p",{className:"text-secondary20",children:s("page.account.info.field.note")})]})]}),e.jsx(re,{})]}),e.jsxs("div",{className:"space-y-4 col-span-5",children:[e.jsx(I,{children:s("page.account.change_pass.heading")}),e.jsxs("form",{className:"space-y-[15px] md:space-y-5",onSubmit:W(J),children:[e.jsxs(u,{children:[e.jsx(x,{htmlFor:"oldPassword",children:s("form.old_password.label")}),e.jsx(b,{type:d?"text":"password",name:"oldPassword",placeholder:s("form.old_password.placeholder"),control:S,children:e.jsx(V,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:d,onClick:f})})]}),e.jsxs(u,{children:[e.jsx(x,{htmlFor:"newPassword",children:s("form.new_password.label")}),e.jsx(b,{type:a?"text":"password",name:"newPassword",placeholder:s("form.new_password.placeholder"),control:S,children:e.jsx(V,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:a,onClick:j})})]}),e.jsxs(u,{children:[e.jsx(x,{htmlFor:"reNewPassword",children:s("form.re_new_password.label")}),e.jsx(b,{type:o?"text":"password",name:"reNewPassword",placeholder:s("form.re_new_password.placeholder"),control:S,children:e.jsx(V,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:o,onClick:G})})]}),e.jsx(D,{type:"submit",className:"w-full text-white bg-primary",children:s("page.account.applyBtn")})]})]})]})},re=()=>{var f;const{t:s,i18n:_}=R(),k=p.useMemo(()=>H({phone:h().required(s("form.phone.error.required")),country:h().required(s("form.country.error.required"))}).required(),[s,_.language]),{_id:c}=m(a=>a.auth),[n,g]=p.useState(),t=L(),{handleSubmit:q,control:T,setValue:l,watch:w}=M({resolver:O(k),mode:"onSubmit"});p.useEffect(()=>{i()},[c]);const i=async()=>{try{const a=await v.get(`/users/${c}`);g(a.data)}catch(a){console.log("error - ",a)}};p.useEffect(()=>{n&&(n.country&&l("country",n.country),n.phone&&l("phone",n.phone))},[n,l]);const C=async a=>{var j;try{await v.patch(`/users/${c}`,{...a});const o=await v.get(`/users/${c}`);t(U(o.data)),P.success(s("page.account.info.success"))}catch(o){if(z.isAxiosError(o))console.log("error message: ",o),P.error((j=o.response)==null?void 0:j.data.message);else return console.log("unexpected error: ",o),"An unexpected error occurred"}},d=w("country");return e.jsx(se,{rolePage:[2],children:e.jsxs("form",{className:"space-y-[15px] md:space-y-5",onSubmit:q(C),children:[e.jsxs(u,{children:[e.jsx(x,{htmlFor:"email",children:s("form.phone.label")}),e.jsx(b,{name:"phone",placeholder:"",control:T})]}),e.jsxs(u,{children:[e.jsx(x,{children:s("form.country.label")}),e.jsxs(N,{children:[e.jsx(N.Select,{placeholder:d?e.jsx("span",{className:"text-black",children:(f=$.find(a=>a.key===d))==null?void 0:f.title}):e.jsx("span",{className:"text-text4",children:s("form.country.placeholder")})}),e.jsx(N.List,{children:$.length>0&&$.map(a=>e.jsx(N.Option,{onClick:()=>l("country",a.key),children:e.jsx("span",{className:"capitalize",children:a.title})},ae()))})]})]}),e.jsx(D,{type:"submit",className:"w-full text-white bg-primary",children:s("page.account.applyBtn")})]})})};export{le as default};
