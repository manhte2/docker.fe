import{r as c,h as v,f as k,a8 as h,q as A,an as E,a9 as T,ac as F,i as I,j as e,z as B,L as x,aa as g,ab as f,I as b,ae as C,k as P,o as z,a as V,az as $,aA as D,aB as G,B as j,l as M}from"./index-DCVJyVHf.js";import{L as R}from"./LayoutAuthentication-u7fbQ64F.js";const K=()=>{const[w,l]=c.useState(!1),{t:a,i18n:y}=v(),L=c.useMemo(()=>k({account:h().required(a("form.account.error.required")),password:h().required(a("form.password.error.required")).min(8,a("form.old_password.error.min"))}).required(),[y.language,a]),{email:i,role:d}=A(n=>n.auth),t=E(),s=T(),{value:u,handleToogleValue:N}=F(),{handleSubmit:S,control:m}=I({resolver:z(L),mode:"onSubmit"});c.useEffect(()=>{i&&s(d===1?"/admin/dashboard":"/user/dashboard")},[i,s,d]);const _=async n=>{var p;try{const{account:o,password:q}=n;l(!0);const r=await V.post("/users/login",{account:o.toLowerCase(),password:q});t($(r.data.data)),t(D("en")),t(G("en")),r.data.data.role===1?s("/admin/dashboard"):r.data.data.role===2?s("/user/dashboard"):r.data.data.role===3&&s("/admin/list-key"),j.success("Login Success")}catch(o){if(M.isAxiosError(o))console.log("error message: ",o),j.error((p=o.response)==null?void 0:p.data.message);else return console.log("unexpected error: ",o),"An unexpected error occurred"}finally{l(!1)}};return e.jsxs(R,{heading:a("login.welcome_back"),children:[w&&e.jsx(B,{}),e.jsxs("p",{className:"mb-[25px] md:mb-[30px] text-xs font-normal text-center md:text-sm md:font-medium text-text3",children:[a("login.dont_have_account")," ",e.jsx(x,{to:"/sign-up",className:"inline font-medium underline text-primary",children:a("authen.sign_up")})]}),e.jsxs("form",{className:"space-y-[15px] md:space-y-5",onSubmit:S(_),children:[e.jsxs(g,{children:[e.jsx(f,{htmlFor:"account",children:a("form.account.label")}),e.jsx(b,{name:"account",placeholder:a("form.account.placeholder"),control:m})]}),e.jsxs(g,{children:[e.jsx(f,{htmlFor:"password",children:a("form.password.label")}),e.jsx(b,{type:u?"text":"password",name:"password",placeholder:a("form.password.placeholder"),control:m,children:e.jsx(C,{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2",open:u,onClick:N})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{to:"/forgot-password",className:"text-sm font-medium cursor-pointer select-none text-primary",children:a("login.forgot_pass")})}),e.jsx(P,{type:"submit",className:"w-full text-white bg-primary",children:a("authen.sign_in")})]})]})};export{K as default};
