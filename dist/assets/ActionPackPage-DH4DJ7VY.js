import{f as $,a8 as g,g as b,ai as v,p as w,a9 as E,r as j,i as P,a as y,j as e,R as T,H as B,aa as a,ab as t,I as u,aj as _,k as A,o as G,B as N,m as I}from"./index-DCVJyVHf.js";import{C as R}from"./Checkbox-CT2LGWNP.js";const V=$({name:g().required().matches(/^[a-zA-Z0-9_-]+$/,"Chỉ viết liền, ký tự thường, hoa, dấu -, _"),description:g().required(),type:g().required(),day:b().required(),price:b().required(),bandWidth:b().required(),enable:v()}).required(),D=()=>{const{packId:l}=w(),f=E(),[c,k]=j.useState(),{handleSubmit:F,control:i,setValue:s,watch:W,formState:{errors:q}}=P({resolver:G(V),mode:"onSubmit"});console.log("errors ~ ",q);const x=W("enable");console.log("enableWatch ~ ",x),j.useEffect(()=>{l&&(async()=>{try{const n=await y.get(`/plans/${l}`);k(n.data)}catch{console.log("error")}})()},[l]),j.useEffect(()=>{if(c){const{name:n,price:r,description:o,type:d,day:h,bandWidth:m,enable:p}=c;s("name",n),s("type",d),s("day",h),s("description",o.join(`
`)),s("price",r),s("bandWidth",m),s("enable",!!p)}},[c]);const C=async n=>{try{if(c){const{name:r,type:o,day:d,description:h,price:m,bandWidth:p,enable:S}=n;await y.patch(`/plans/${l}`,{name:r,price:m,type:o,day:d,description:h.split(`
`),bandWidth:p,enable:S?1:0}),N.success("Chỉnh sửa thành công"),f("/admin/pack")}else{const{name:r,type:o,day:d,description:h,price:m,bandWidth:p}=n;await y.post("/plans",{name:r,price:m,type:o,day:d,description:h.split(`
`),bandWidth:p}),N.success("Thêm thành công"),f("/admin/pack")}}catch(r){console.log(r),N.error(I.error)}};return e.jsx(T,{rolePage:[1],children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:"Thêm gói cước mới"}),e.jsxs("form",{className:"grid grid-cols-2 lg:grid-cols-6 gap-6",onSubmit:F(C),children:[e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"name",children:"Mã/Tên gói cước*"}),e.jsx(u,{name:"name",control:i})]}),e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"price",children:"Giá gói cước*"}),e.jsx(u,{name:"price",control:i,type:"number",min:0,children:e.jsx("p",{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2 font-semibold text-icon-color",children:"VND"})})]}),e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"bandWidth",children:"Băng thông*"}),e.jsx(u,{name:"bandWidth",control:i,type:"number",min:0,children:e.jsx("p",{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2 font-semibold text-icon-color",children:"GB"})})]}),e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"type",children:"Chu kỳ(Vietnam_English_Chinese)*"}),e.jsx(u,{name:"type",control:i})]}),e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"day",children:"Ngày*"}),e.jsx(u,{name:"day",control:i,type:"number",min:0,children:e.jsx("p",{className:"absolute -translate-y-1/2 cursor-pointer right-5 top-1/2 font-semibold text-icon-color",children:"Ngày"})})]}),c&&l&&e.jsxs(a,{className:"col-span-2",children:[e.jsx(t,{htmlFor:"day",children:"Status*"}),e.jsx("div",{className:"flex items-center h-full",children:e.jsx(R,{checked:x,onClick:()=>s("enable",!x),children:"Enable"})})]}),e.jsxs(a,{className:"col-span-2 lg:col-span-6",children:[e.jsx(t,{htmlFor:"description",children:"Nội dung gói cước*"}),e.jsx(_,{name:"description",control:i,className:"min-h-[300px]"})]}),e.jsx(a,{children:e.jsx(A,{type:"submit",className:"w-full text-white bg-primary mt-auto",children:c?"Chỉnh sửa":"Thêm mới"})})]})]})})};export{D as default};
